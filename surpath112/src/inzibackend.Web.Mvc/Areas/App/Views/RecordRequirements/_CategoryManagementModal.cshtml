@using inzibackend.Authorization
@using inzibackend.Web.Areas.App.Models.RecordRequirements
@using inzibackend.Web.Areas.App.Models.Common.Modals
@model CategoryManagementModalViewModel

@await Html.PartialAsync("~/Areas/App/Views/Common/Modals/_ModalHeader.cshtml", new ModalHeaderViewModel(L("ManageCategories")))

<div class="modal-body">
                <div class="form-group mb-3">
                    <label class="form-label">@L("RecordRequirement")</label>
                    <p id="requirementName" class="form-control-plaintext fw-bold">@Model.RequirementName</p>
                    <input type="hidden" id="requirementId" value="@Model.RequirementId" />
                </div>
                
                <div class="form-group">
                    <label class="form-label">@L("RecordCategories")</label>
                    <div class="table-responsive">
                        <table class="table table-hover table-striped" id="CategoriesTable">
                            <thead>
                                <tr>
                                    <th style="width: 40px;">
                                        <div class="form-check">
                                            <input type="checkbox" class="form-check-input" id="selectAllCategories" />
                                            <label class="form-check-label" for="selectAllCategories"></label>
                                        </div>
                                    </th>
                                    <th>@L("Name")</th>
                                    <th>@L("Instructions")</th>
                                    <th style="width: 100px;">@L("RecordCount")</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.Categories.Any())
                                {
                                    @foreach (var category in Model.Categories)
                                    {
                                        <tr>
                                            <td>
                                                <div class="form-check">
                                                    <input type="checkbox" class="form-check-input category-checkbox" value="@category.CategoryId" id="category_@category.CategoryId" />
                                                    <label class="form-check-label" for="category_@category.CategoryId"></label>
                                                </div>
                                            </td>
                                            <td>@category.CategoryName</td>
                                            <td>@(category.Instructions ?? "")</td>
                                            <td class="text-center">
                                                <span class="badge badge-light">@category.RecordStatesCount</span>
                                            </td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="4" class="text-center text-muted">@L("NoDataAvailable")</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="categorySelectionInfo" class="alert alert-info d-none">
                    <i class="fa fa-info-circle"></i>
                    <span id="selectedCategoryCount">0</span> @L("CategoriesSelected")
                </div>
</div>

<div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">@L("Cancel")</button>
    @if (IsGranted(AppPermissions.Pages_Administration_RecordRequirements_MoveCategories))
    {
        <button type="button" class="btn btn-primary" id="moveSelectedCategories">
            <i class="fa fa-arrows-alt"></i> @L("MoveCategories")
        </button>
    }
    @if (IsGranted(AppPermissions.Pages_Administration_RecordRequirements_CopyCategories))
    {
        <button type="button" class="btn btn-info" id="copySelectedCategories">
            <i class="fa fa-copy"></i> @L("CopyCategories")
        </button>
    }
</div> 